(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4490:function(e,t,r){Promise.resolve().then(r.bind(r,8431))},8431:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Home}});var a=r(7437),s=r(2265);let n=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))});function SearchForm(e){let{onSearch:t,setIsLoading:r}=e,[l,i]=(0,s.useState)(""),handleSubmit=async e=>{if(e.preventDefault(),l.trim()){r(!0);try{let e=await fetch("/api/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:l.trim()})});if(!e.ok)throw Error("搜索失败");let r=await e.json();t(r.novels)}catch(e){console.error("搜索错误:",e),alert("搜索失败，请稍后重试")}finally{r(!1)}}};return(0,a.jsxs)("div",{className:"card max-w-2xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 text-center",children:"搜索小说"}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:l,onChange:e=>i(e.target.value),placeholder:"输入小说名称...",className:"input-field pl-10",required:!0})]}),(0,a.jsx)("button",{type:"submit",className:"btn-primary w-full",disabled:!l.trim(),children:"开始搜索"})]}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"\uD83D\uDCA1 使用提示"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,a.jsx)("li",{children:"• 输入小说名称，AI会自动搜索相关信息"}),(0,a.jsx)("li",{children:"• 系统会自动分析小说简介并分类"}),(0,a.jsx)("li",{children:"• 确认信息后可以保存到收藏夹"}),(0,a.jsx)("li",{children:"• 支持导出到飞书文档"})]})]})]})}let l=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}),i=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"}))});function NovelResults(e){let{novels:t,onSave:r,isLoading:n}=e,[o,c]=(0,s.useState)(new Set),handleSave=e=>{let t="".concat(e.title,"-").concat(e.author);c(e=>{let r=new Set(e);return r.add(t),r}),r(e)},isSaved=e=>{let t="".concat(e.title,"-").concat(e.author);return o.has(t)},getCategoryColor=e=>{let t={暗恋文:"bg-pink-100 text-pink-800",救赎文:"bg-purple-100 text-purple-800",豪门文:"bg-yellow-100 text-yellow-800",先婚后爱文:"bg-red-100 text-red-800",校园文:"bg-green-100 text-green-800",都市文:"bg-blue-100 text-blue-800",古言文:"bg-orange-100 text-orange-800",现言文:"bg-indigo-100 text-indigo-800",其他:"bg-gray-100 text-gray-800"};return t[e]||t["其他"]};return n?(0,a.jsx)("div",{className:"card max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"正在搜索中..."})]})}):0===t.length?null:(0,a.jsxs)("div",{className:"card max-w-4xl mx-auto",children:[(0,a.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:["搜索结果 (",t.length,")"]}),(0,a.jsx)("div",{className:"space-y-6",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:e.title}),(0,a.jsxs)("p",{className:"text-gray-600 mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"作者："}),e.author]}),(0,a.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-medium ".concat(getCategoryColor(e.category)),children:e.category})]}),(0,a.jsx)("button",{onClick:()=>handleSave(e),disabled:isSaved(e),className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ".concat(isSaved(e)?"bg-green-100 text-green-700 cursor-not-allowed":"bg-primary-50 text-primary-700 hover:bg-primary-100"),children:isSaved(e)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"已保存"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"保存"})]})})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"简介："}),(0,a.jsx)("p",{className:"text-gray-700 leading-relaxed",children:e.description})]}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-500",children:["搜索时间：",e.searchDate]})]},t))})]})}let o=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}),c=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"}))}),d=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});function SavedNovels(e){let{novels:t,onRemove:r}=e,[n,l]=(0,s.useState)("全部"),[i,m]=(0,s.useState)(!1),x=["全部",...Array.from(new Set(t.map(e=>e.category)))],h="全部"===n?t:t.filter(e=>e.category===n),getCategoryColor=e=>{let t={暗恋文:"bg-pink-100 text-pink-800",救赎文:"bg-purple-100 text-purple-800",豪门文:"bg-yellow-100 text-yellow-800",先婚后爱文:"bg-red-100 text-red-800",校园文:"bg-green-100 text-green-800",都市文:"bg-blue-100 text-blue-800",古言文:"bg-orange-100 text-orange-800",现言文:"bg-indigo-100 text-indigo-800",其他:"bg-gray-100 text-gray-800"};return t[e]||t["其他"]},handleExportToFeishu=async()=>{if(0===t.length){alert("没有小说可以导出");return}m(!0);try{let e=await fetch("/api/export-feishu",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({novels:t})});if(!e.ok)throw Error("导出失败");let r=await e.json();alert("成功导出到飞书文档！文档链接：".concat(r.documentUrl))}catch(e){console.error("导出错误:",e),alert("导出失败，请稍后重试")}finally{m(!1)}};return 0===t.length?(0,a.jsxs)("div",{className:"card max-w-4xl mx-auto text-center py-12",children:[(0,a.jsx)(o,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"还没有收藏的小说"}),(0,a.jsx)("p",{className:"text-gray-600",children:"搜索并保存你喜欢的小说吧！"})]}):(0,a.jsxs)("div",{className:"card max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900",children:["我的收藏 (",t.length,")"]}),(0,a.jsxs)("button",{onClick:handleExportToFeishu,disabled:i,className:"btn-primary flex items-center space-x-2",children:[(0,a.jsx)(c,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:i?"导出中...":"导出到飞书"})]})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:x.map(e=>(0,a.jsx)("button",{onClick:()=>l(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(n===e?"bg-primary-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e},e))})}),(0,a.jsx)("div",{className:"space-y-6",children:h.map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:e.title}),(0,a.jsxs)("p",{className:"text-gray-600 mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"作者："}),e.author]}),(0,a.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-medium ".concat(getCategoryColor(e.category)),children:e.category})]}),(0,a.jsxs)("button",{onClick:()=>r(e),className:"flex items-center space-x-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[(0,a.jsx)(d,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"删除"})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"简介："}),(0,a.jsx)("p",{className:"text-gray-700 leading-relaxed",children:e.description})]}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-500 flex justify-between",children:[(0,a.jsxs)("span",{children:["搜索时间：",e.searchDate]}),e.savedDate&&(0,a.jsxs)("span",{children:["保存时间：",e.savedDate]})]})]},t))}),0===h.length&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"该分类下没有收藏的小说"})]})}function Home(){let[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)([]),[l,i]=(0,s.useState)(!1),[o,c]=(0,s.useState)("search");return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"\uD83D\uDCDA 小说助手"}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"AI智能搜索、分类和保存你喜爱的小说"})]}),(0,a.jsx)("div",{className:"flex justify-center mb-8",children:(0,a.jsxs)("div",{className:"flex bg-white rounded-lg p-1 shadow-md",children:[(0,a.jsx)("button",{onClick:()=>c("search"),className:"px-6 py-2 rounded-md font-medium transition-colors ".concat("search"===o?"bg-primary-500 text-white":"text-gray-600 hover:text-gray-900"),children:"搜索小说"}),(0,a.jsxs)("button",{onClick:()=>c("saved"),className:"px-6 py-2 rounded-md font-medium transition-colors ".concat("saved"===o?"bg-primary-500 text-white":"text-gray-600 hover:text-gray-900"),children:["我的收藏 (",r.length,")"]})]})}),"search"===o?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(SearchForm,{onSearch:t,setIsLoading:i}),(0,a.jsx)(NovelResults,{novels:e,onSave:e=>{n(t=>{let r=t.find(t=>t.title===e.title&&t.author===e.author);return r?t:[...t,e]})},isLoading:l})]}):(0,a.jsx)(SavedNovels,{novels:r,onRemove:e=>{n(t=>t.filter(t=>!(t.title===e.title&&t.author===e.author)))}})]})}},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=r(2265),s=Symbol.for("react.element"),n=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var a,n={},c=null,d=null;for(a in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,a)&&!o.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:s,type:e,key:c,ref:d,props:n,_owner:i.current}}t.Fragment=n,t.jsx=q,t.jsxs=q},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[971,472,744],function(){return e(e.s=4490)}),_N_E=e.O()}]);